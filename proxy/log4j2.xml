<?xml version="1.0" encoding="UTF-8"?>
<!-- Velocity Proxy Log Rotation Configuration -->
<!-- Why: Prevents logs from filling up disk space, auto-compresses old logs -->
<Configuration status="WARN">
  <Appenders>
    <!-- Console output (what you see in docker logs) -->
    <Console name="Console" target="SYSTEM_OUT">
      <PatternLayout pattern="[%d{HH:mm:ss} %level]: %msg%n" />
    </Console>

    <!-- Rolling file output (logs/latest.log) -->
    <!-- Rotates: Only when file hits 100MB (no daily rotation) -->
    <!-- Keeps: Last 14 days of logs -->
    <!-- Compression: Gzip (.gz) for old logs -->
    <RollingRandomAccessFile name="File" fileName="logs/latest.log" filePattern="logs/%d{yyyy-MM-dd}-%i.log.gz" immediateFlush="false">
      <PatternLayout pattern="[%d{HH:mm:ss} %level] [%t]: %msg%n" />
      <Policies>
        <!-- Rotate when file hits 100MB (increased from 50MB) -->
        <SizeBasedTriggeringPolicy size="100MB" />
      </Policies>
      <!-- Keep max 14 log files, delete older ones -->
      <DefaultRolloverStrategy max="14" fileIndex="min">
        <Delete basePath="logs" maxDepth="1">
          <IfFileName glob="*.log.gz" />
          <!-- Delete logs older than 14 days -->
          <IfLastModified age="14d" />
        </Delete>
      </DefaultRolloverStrategy>
    </RollingRandomAccessFile>
  </Appenders>

  <Loggers>
    <!-- Root logger: Send to both console and file -->
    <Root level="info">
      <AppenderRef ref="Console" level="info" />
      <AppenderRef ref="File" level="info" />
    </Root>
  </Loggers>
</Configuration>